<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stacja 2</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet" />
<link rel="icon" href="bhl.jpg" type="image/jpeg">
    <link rel="shortcut icon" href="bhl.jpg" type="image/jpeg">
  <style>
    :root {
      --accent: #00ffcc;
      --bg: #050507;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--accent);
      font-family: 'Share Tech Mono', monospace;
    }
    .matrix {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      overflow: hidden;
      background: var(--bg);
    }
    canvas { display: block; width: 100%; height: 100%; }
    .container {
      position: relative;
      z-index: 1;
      max-width: 820px;
      margin: 80px auto;
      background: rgba(0, 0, 0, 0.85);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 24px 28px;
      box-shadow: 0 0 25px rgba(0, 255, 204, 0.2);
      text-align: center;
    }
    h2 {
      color: #ff0055;
      margin-bottom: 16px;
      font-size: 1.9rem;
      line-height: 1.3;
    }
    p, code {
      font-size: 1.1rem;
      font-weight: 700;
      word-break: break-word;
    }
    code {
      display: block;
      margin: 12px 0;
      font-size: 1.2rem;
      line-height: 1.4;
      word-wrap: break-word;
    }
    input {
      width: 100%;
      padding: 14px;
      margin-top: 12px;
      box-sizing: border-box;
      background: #000;
      border: 2px solid var(--accent);
      color: var(--accent);
      border-radius: 8px;
      font-weight: 700;
      font-size: 1rem;
    }
    button {
      width: 100%;
      margin-top: 16px;
      padding: 14px;
      background: none;
      border: 2px solid var(--accent);
      color: var(--accent);
      border-radius: 8px;
      font-weight: 700;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    button:hover {
      background: var(--accent);
      color: #000;
    }
    .decoded {
      margin-top: 18px;
      text-align: center;
      background: rgba(0, 255, 204, 0.05);
      border: 1px solid var(--accent);
      padding: 16px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      box-shadow: 0 0 12px rgba(0, 255, 204, 0.3);
    }
    .error {
      margin-top: 18px;
      color: #ff6b6b;
      font-weight: 700;
      animation: blink 1s step-start infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }
    @media (max-width: 600px) {
      .container {
        margin: 40px 12px;
        padding: 18px 16px;
      }
      h2 {
        font-size: 1.4rem;
      }
      p, code {
        font-size: 1rem;
      }
      code {
        font-size: 1.05rem;
      }
      input, button {
        font-size: 0.95rem;
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="matrix" id="matrix">
    <canvas id="matrixCanvas" aria-hidden="true"></canvas>
  </div>

  <div class="container" id="taskContainer">
    <h2>&gt; STACJA [2/4] â€“ SZYFR: MORSE'A</h2>
    <p>Znaleziono zakodowany przekaz:</p>
    <code>.-. . -..- / .-. ..- -- -... .-.. .</code>
    <p>Odszyfruj i wpisz treÅ›Ä‡ (bez spacji):</p>
    <input id="morseInput" type="text" placeholder="Twoja odpowiedÅº" autocomplete="off" />
    <button id="checkBtn">SPRAWDÅ¹</button>
  </div>

  <div class="container" id="morseResult" style="display: none"></div>

  <script>
  (function() {
    // MATRIX ANIMACJA
    const canvas = document.getElementById('matrixCanvas');
    const ctx = canvas.getContext('2d');
    let W = 0, H = 0;
    const DPR = window.devicePixelRatio || 1;

    function resizeCanvas() {
      W = window.innerWidth; H = window.innerHeight;
      canvas.style.width = W + 'px'; canvas.style.height = H + 'px';
      canvas.width = Math.floor(W * DPR); canvas.height = Math.floor(H * DPR);
      ctx.setTransform(DPR,0,0,DPR,0,0);
      buildSymbols();
    }

    const SYMBOLS = ['ðŸ¦–','ðŸ¦•'];
    const BASE_COUNT = 50;
    const SIZES = [16,20,24,28,32];
    let items = [];

    function rand(min,max){return min + Math.random()*(max-min);}
    function pick(arr){return arr[Math.floor(Math.random()*arr.length)];}

    class Dino {
      constructor(){this.reset(true);}
      reset(initial=false){
        this.x = rand(0,W);
        this.y = initial? rand(-H,H): rand(-H*0.6,-20);
        this.size = pick(SIZES)*(0.85+Math.random()*0.7);
        this.symbol = pick(SYMBOLS);
        this.speed = (40/this.size)*(0.6+Math.random()*1.4);
        this.sway = rand(0.3,1.5);
        this.phase = Math.random()*Math.PI*2;
        this.alpha = rand(0.6,1.0);
      }
      update(dt){
        this.y += this.speed*(dt/16);
        this.x += Math.sin(this.y*0.02+this.phase)*this.sway*(dt/16)*0.4;
        if(this.y > H + this.size + 20) this.reset(false);
      }
      draw(ctx){
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.font = `${Math.round(this.size)}px serif`;
        ctx.textAlign='center'; ctx.textBaseline='top';
        ctx.fillStyle='var(--accent)';
        ctx.fillText(this.symbol,this.x,this.y);
        ctx.restore();
      }
    }

    function buildSymbols(){
      const density = Math.max(0.5, Math.min(1.5, W/900));
      const count = Math.floor(BASE_COUNT*density);
      items=[]; for(let i=0;i<count;i++) items.push(new Dino());
    }

    let last=performance.now(); let rafId=null;
    function animate(now){
      const dt = now - last;
      last = now;
      ctx.clearRect(0,0,W,H);
      for(const it of items){ it.update(dt); it.draw(ctx); }
      rafId=requestAnimationFrame(animate);
    }

    resizeCanvas(); last=performance.now(); rafId=requestAnimationFrame(animate);

    let rto=null;
    window.addEventListener('resize', ()=> {
      clearTimeout(rto);
      rto=setTimeout(()=> {
        cancelAnimationFrame(rafId);
        resizeCanvas();
        last=performance.now();
        rafId=requestAnimationFrame(animate);
      },150);
    });

    // LOGIKA STACJI
    const input = document.getElementById('morseInput');
    const result = document.getElementById('morseResult');
    const task = document.getElementById('taskContainer');
    document.getElementById('checkBtn').addEventListener('click', checkMorse);

    const correctHash = "UmV4UnVtYmxl";

    function normalizeAnswer(s){
      return s.trim().toLowerCase().replace(/[Ä…Ä‡Ä™Å‚Å„Ã³Å›Å¼Åº]/g,c=>({
        Ä…:'a',Ä‡:'c',Ä™:'e',Å‚:'l',Å„:'n',Ã³:'o',Å›:'s',Å¼:'z',Åº:'z'
      }[c]||c)).replace(/\s+/g,' ');
    }

    function checkMorse(){
      const val = normalizeAnswer(input.value);
      const decoded = atob(correctHash).toLowerCase();
      task.style.display='none';
      result.style.display='block';
      if(val===decoded){
        result.innerHTML=`
          <div class="decoded">
            <p style="color:#00ffcc; font-size:1.5rem; font-weight:bold;">ODPOWIEDÅ¹ POPRAWNA</p>
            <button onclick="location.href='online3.html'" style="margin-top:20px;">STACJA 3</button>
          </div>
        `;
      } else {
        result.innerHTML=`
          <div class="error">
            â–ˆâ–ˆâ–ˆ SYSTEM ERROR â–ˆâ–ˆ<br>
            BÅ‚Ä…d dekodowania...<br>
            <button onclick="location.reload()">&gt; RESETUJ STACJÄ˜</button>
          </div>
        `;
      }
    }
  })();
  </script>
</body>
</html>
